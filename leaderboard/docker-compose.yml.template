version: '3.8'
services:
  green-agent:
    image: ${GREEN_AGENT_IMAGE}
    environment:
      - GOOGLE_API_KEY=${GOOGLE_API_KEY}
      - GREEN_AGENT_HOST=0.0.0.0
      - GREEN_AGENT_PORT=9009
    ports:
      - "9009:9009"
    command: ["--host", "0.0.0.0", "--port", "9009"]
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9009/.well-known/agent-card.json"]
      interval: 10s
      timeout: 5s
      retries: 5

  purple-agent:
    image: ${PURPLE_AGENT_IMAGE}
    environment:
      - GOOGLE_API_KEY=${GOOGLE_API_KEY}
      - PURPLE_AGENT_HOST=0.0.0.0
      - PURPLE_AGENT_PORT=9019
    ports:
      - "9019:9019"
    command: ["--host", "0.0.0.0", "--port", "9019"]
    depends_on:
      green-agent:
        condition: service_healthy
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9019/.well-known/agent-card.json"]
      interval: 10s
      timeout: 5s
      retries: 5